<div class="dropzone my-dropzone" id="form_snippet_image" action="{{path('ajax_snippet_image_send')}}">
</div>
<input type="text" name="Element To Be Copied" id="copy-me" value="BONJOUUUUR"/>
<button id="copy-btn">Copy</button><br/><br/>
{% set explodeRoute = app.request.attributes.get('_route')|split('_') %}
{% set operation = explodeRoute|last %}
{{ form_start(form) }}
<div class="my-custom-class-for-errors">
    {{ form_errors(form) }}
</div>
<div class="row bloc-body-content">
    <div class="col-12 left-0">
        {{ form_label(form.titre, 'Titre', {'label_attr': {'class': 'font-weight-bold'} }) }}
    </div>
    <div class="col-12 left-0">
        {{ form_widget(form.titre) }}
    </div>
    <div class="col-12 left-0">
        {{ form_label(form.message, 'Message', {'label_attr': {'class': 'font-weight-bold'} }) }}
    </div>
    <div class="col-12 left-0">
        {{ form_widget(form.message)}}
    </div>
</div>
<br/>
<span style='float:right'>
    {{ include('button.html.twig', {'type_button': type_button, 'button_label': button_label, 'icon_label': icon_label}) }}
</span>
{{ form_end(form) }}
<div class="btn-group" role="group" style="float:left" aria-label="Third group">
    {% if operation == 'edit' %}
        {{ include('actualite/_delete_form.html.twig') }}
    {% endif %}
    <a href="{{ path('actualite_index') }}">
        {{ include('button.html.twig', {'type_button': 'outline-dark', 'button_label': "Retour à l'accueil", 'icon_label': 'fa-undo-alt' }) }}
    </a>
</div>
<div id="thumbnail">
{#<div class="dz-preview dz-file-preview"><div class="dz-details"><div class="dz-filename"><span data-dz-name></span></div><div class="dz-size" data-dz-size></div><img data-dz-thumbnail /></div><div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div><div class="dz-success-mark"><span>✔</span></div><div class="dz-error-mark"><span>✘</span></div><div class="dz-error-message"><span data-dz-errormessage></span></div></div>#}
<div class="dz-preview dz-processing dz-image-preview dz-success dz-complete">  <div class="dz-image"><img data-dz-thumbnail></div>  <div class="dz-details">    <div class="dz-size"><span data-dz-size=""><strong></strong> </span></div>    <div class="dz-filename"><span data-dz-name=""></span></div>  </div>  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress="" style="width: 100%;"></span></div>  <div class="dz-error-message"><span data-dz-errormessage=""></span></div>  <div class="dz-success-mark">  </div>  <div class="dz-error-mark"></div><a class="dz-remove" href="javascript:undefined;" data-dz-remove=""><a class="dz-remove" data-dz-remove=""><i class="fas fa-trash-alt icon-delete-dz" aria-hidden="true" data-dz-remove=""></i></a><button value="" id="copied_link" class="btn btn-download" href="#">Copier</button></div></div>
<script>

    var copyBtn = $("#copy-btn"),
            input = $("#copy-me");

    function copyToClipboardFF(text) {
        window.prompt("Copy to clipboard: Ctrl C, Enter", text);
    }

    function copyToClipboard() {
        var success = true,
                range = document.createRange(),
                selection;

        // For IE.
        if (window.clipboardData) {
            window.clipboardData.setData("Text", input.val());
        } else {
            // Create a temporary element off screen.
            var tmpElem = $('<div>');
            tmpElem.css({
                position: "absolute",
                left: "-1000px",
                top: "-1000px",
            });
            // Add the input value to the temp element.
            tmpElem.text(input.val());
            $("body").append(tmpElem);
            // Select temp element.
            range.selectNodeContents(tmpElem.get(0));
            selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            // Lets copy.
            try {
                success = document.execCommand("copy", false, null);
            } catch (e) {
                copyToClipboardFF(input.val());
            }
            if (success) {
                //alert ("The text is on the clipboard, try to paste it!");
                // remove temp element.
                tmpElem.remove();
            }
        }
    }

    copyBtn.on('click', copyToClipboard);

    Dropzone.autoDiscover = false;
    $(function () {
        //je récupère l'action où sera traité l'upload en PHP
        var _actionToDropZone = $("#form_snippet_image").attr('action');
        //console.log(window.Dropzone);
        //je définis ma zone de drop grâce à l'ID de ma div citée plus haut.
        //Dropzone.autoDiscover = false;


        var myDropzone = new Dropzone("#form_snippet_image", {url: _actionToDropZone,
            dictInvalidFileType: 'Ce fichier n\'est pas conforme. Il n\'est donc pas téléchargeable.',
            //addRemoveLinks: true,
            previewTemplate: document.querySelector('#thumbnail').innerHTML,
            acceptedFiles: ".png,.jpg,.gif,.jpeg",
            //dictRemoveFile: '<a class="dz-remove" data-dz-remove><i class="fas fa-trash-alt icon-delete-dz" aria-hidden="true" data-dz-remove></i></a><span role="button" class="copy_link">Copier lien</span>',
            dictDefaultMessage: '<i class="msg-default-dropzone">Cliquer ou Déposer vos fichiers à télécharger ici.</i>',
            removedfile: function (file) {
                var name = file.upload.filename;
                //this.removeFile(file);
                $.ajax({
                    type: 'POST',
                    url: '{{ path('ajax_snippet_image_delete') }}',
                    data: {name: name, request: 2},
                    sucess: function (data) {
                        console.log('success: ' + data);
                    }
                });
                var _ref;
                return (_ref = file.previewElement) != null ? _ref.parentNode.removeChild(file.previewElement) : void 0;
            },
            renameFile: function (file) {
                let newName = new Date().getTime() + '_' + file.name;
                $('#copied_link').val(newName);
                return newName;
            }

        });
        myDropzone.on("complete", function (file) {
            //file.name = $.now()+''+file.upload.filename;

        });
        myDropzone.on("addedfile", function (file) {
//            alert('nouveau fichier reçu');
        });
    });


</script>